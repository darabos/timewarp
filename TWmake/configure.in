## Timewarp makefile version 1.0 by Karl Bartel <karlb@gmx.net>

######## Process this file with autoconf to produce a configure script.
AC_INIT("help.txt")

######## Setup for automake
NAME="timewarp"
VERSION="0.0.?"

######## Detect the canonical host and target build environment
AC_CANONICAL_HOST
AC_CANONICAL_TARGET

######## Check for tools
AC_PROG_CXX
AC_PROG_INSTALL

######## Check for compiler environment
AC_C_CONST

#LDFLAGS="`allegro-config --libs` -laatsr"
#AC_TRY_LINK("#include <allegro.h>","int main(){} END_OF_MAIN();", LIBS="-laastr $LIBS", CXXFLAGS="-DNO_AASTR $CXXFLAGS",`allegro-config --libs`)

######## Take care of defines for the network code
case "$target" in
    *-*-linux*)
	CXXFLAGS="-Dlinuxnet $CXXFLAGS"
	;;
esac

######## Check for libs
# AC_CHECK_LIB(alleg_unsharable, main, , AC_MSG_ERROR(Your system is missing allegro!),`allegro-config --libs`)
# AC_CHECK_LIB(aastr, main, LIBS="-laastr $LIBS", CXXFLAGS="-DNO_AASTR $CXXFLAGS",`allegro-config --libs`)
# AC_CHECK_LIB(jgmod, main, LIBS="-ljgmod $LIBS", CXXFLAGS="-DNO_JGMOD $CXXFLAGS",`allegro-config --libs`)

AC_SUBST(CXXFLAGS)

######## Check for headers
AC_CHECK_HEADERS(allegro.h, , AC_MSG_ERROR(Your system is missing allegro.h !))
AC_CHECK_HEADERS(aastr.h, LIBS="-laastr $LIBS", CXXFLAGS="-DNO_AASTR $CXXFLAGS")
AC_CHECK_HEADERS(jgmod.h, LIBS="-ljgmod $LIBS", CXXFLAGS="-DNO_JGMOD $CXXFLAGS")

AC_SUBST(LIBS)

######## Finally create all the generated files
AC_OUTPUT([
Makefile
source/Makefile
])

